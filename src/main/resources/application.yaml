spring:
  # 1. Lokales Profil laden (application-local.yaml) – lädt DB-Passwörter & Secrets
  profiles:
    active: local

  # 2. Datenbankverbindung – Werte MÜSSEN als Env-Vars oder im lokalen Profil gesetzt sein
  datasource:
    url: jdbc:postgresql://localhost:5432/${DB_NAME:sparkcore_db}
    username: ${DB_USERNAME:sparkcore_user}
    password: ${DB_PASSWORD:sparkcore_pass}
    driver-class-name: org.postgresql.Driver

  # 3. Hibernate – validiert das Schema (Flyway übernimmt die Erstellung)
  #    show-sql und format_sql nur im lokalen Profil aktivieren!
  jpa:
    open-in-view: false   # verhindert lazy-load Queries außerhalb der Service-Schicht
    hibernate:
      ddl-auto: validate

  # 4. Flyway – automatische Datenbankmigrationen
  flyway:
    enabled: true

# 5. JWT Konfiguration – Secret MUSS als Env-Var JWT_SECRET gesetzt sein!
application:
  security:
    jwt:
      secret-key: ${JWT_SECRET}

# 6. Spring Boot Actuator – nur sichere Endpunkte öffentlich
#    Weitere Endpunkte (env, beans, conditions) nur über Env-Var oder lokales Profil aktivieren
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when-authorized